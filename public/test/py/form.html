<html>
<head>
<meta charset="utf-8">
<title>菜鸟教程(runoob.com)</title>
	<link rel="stylesheet" href="style/main.css">
</head>
<script type="text/javascript" src="js/jQuery.min.js"></script>
	
<body>
	
					<form action="pic.php" method="post" enctype="multipart/form-data">
						<div id="picInput">
							<div class="pengyou_upload_input" id="pengyou_upload_input">
								<!--<img id="img_preview" data-src="" src="" data-holder-rendered="true" style="width: 100px; display: block;">-->
								<input type="button" onClick="uploadbut()" id="tjimg" cs='0'>
							</div>
						<input type="file" name="myfile[]" id="zx_img0" style="padding: 0px;" style='display:none'>
						</div>
						<input id="addBtn" type="button" onclick="addPic1()" value="继续添加图片"><br/><br/>
						<input type="submit" value="上传文件">
					</form>



</body>
	<script>
		var z = 0;
		var uploadbut = function(){
				var cs = parseInt($('#tjimg').attr("cs"))+1;
				$('#tjimg').attr('cs',cs)
				var cjimg = document.createElement('img');
					cjimg.id = 'img_preview'+cs;
					cjimg.src=' ';
					cjimg.style.height=8+'rem';
					cjimg.style.width=8+'rem';
				$('#pengyou_upload_input').append(cjimg);
				var cjimgbut = document.createElement('input');
					cjimgbut.tpye='file';
					cjimgbut.name='myfile[]';
					cjimgbut.id='zx_img';
					cjimgbut.style.display='none';
				$('#picInput').append(cjimgbut);
				$("#zx_img").click();
					z++;
			}
		function addPic1(){
        var addBtn =  document.getElementById('addBtn');
        var input = document.createElement("input");
        input.type = 'file';
        input.name = 'myfile[]';
        var picInut = document.getElementById('picInput');
        picInut.appendChild(input);
        if(picInut.children.length == 3){
            addBtn.disabled = 'disabled';
        }
    }
//上传图片选择文件改变后刷新预览图
		var cs=$('#tjimg').attr('cs');
$("#zx_img"+cs).change(function (e) {
//获取目标文件
	console.log(e);
var file = e.target.files || e.dataTransfer.files;
//如果目标文件存在
if (file) {
//定义一个文件阅读器
var reader = new FileReader();
//文件装载后将其显示在图片预览里
reader.onload = function () {
	var id =$('#tjimg').attr('cs');
$("#img_preview"+id).attr("src", this.result);
}
//装载文件
reader.readAsDataURL(file[0]);
}
});
</script>
</html>